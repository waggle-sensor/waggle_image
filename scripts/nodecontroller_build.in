

### Node Controller Specific Commands ###

# this will make sure that an empty eMMC card will get the waggle image
touch /root/do_recovery

echo -e "10.31.81.51\textensionnode1 extensionnode" >> /etc/hosts
for i in 2 3 4 5 ; do
  echo -e "10.31.81.5${i}\textensionnode${i}" >> /etc/hosts
done


echo -e "127.0.0.1\tnodecontroller" >> /etc/hosts

set +e


### get nodecontroller repo
if [ ! -d /usr/lib/waggle/nodecontroller ] ; then
  mkdir -p /usr/lib/waggle/
  git clone --recursive https://github.com/waggle-sensor/nodecontroller.git /usr/lib/waggle/nodecontroller
else  
  cd /usr/lib/waggle/nodecontroller
  git pull
fi

cd /usr/lib/waggle/nodecontroller
./scripts/install_dependencies.sh

# wagman client
cd /usr/lib/waggle/nodecontroller/wagman
./configure

# Over-air WagMan firmware update tools
apt-get install --yes bossa-cli
apt-get install --yes avrdude

#########################################


